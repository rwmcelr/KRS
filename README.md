# KRS
An R based RNA sequencing analysis project focused on Kaposi's Sarcoma Herpes Virus.

KRS takes RNA-seq input in the form of a count table, in this case generated by featureCounts from the Subread package.  Data importing occurs in main.R, which will require modification for use with other inputted data (sample groups need to be manually input, and formatting needs to change if counts table is generated by another program).  Analysis of raw input data is done using the DESeq2 package.  Plots and downstream analysis are generated by a number of functions, described below.

<ins>**SGaP**</ins> serves as a container function for the rest of the downstream analysis.  Arguments passed into this function are as follows:
<br>name - String used for naming of output folder, as well as the base name for subsequent output files
<br>dds - DESeq object generated previously in main.R
<br>filterBy - Statistic used to filter out results; can choose between adjusted p-value and unadjusted p-value; defaults to adjusted p-value
<br>filterVal - Number value associated with the filter statistic, filters below input value; defaults to 0.05
<br>con1 - First comparison condition, needs to exist as a group in the dds object
<br>con2 - Second comparison condition, needs to exist as a group in the dds object
<br>GS - Optional geneset flag, if set to true the functions will look for a GeneSet.csv file in the data directory, which should have a single column of target genes, with "symbol" as the first entry.  When enabled, analysis will generate additional CSV containing only data for specified genes, and will highlight the same genes in all generated graphs.

<ins>**(P)athway (E)nrichment (A)analysis**</ins> uses the PathwayData.csv generated by SGaP to perform downstream pathway enrichment analysis from a variety of sources on the differentially expressed genes identified by DESeq2.  The databases used in this analysis are GO (Gene Ontology), KEGG, Reactome, and WikiPathways.  PEA utilizes 2 methods for generating the results; overrepresentation analysis (ORA), as well as gene set enrichment analysis (GSEA - this method is currently non-operational).  The only argument needed is the name of the folder in which analysis should proceed.

<ins>**Output files:**</ins>
- Differentially expressed gene table (shrunken and non-shrunken) [from getSigGenes]
- Gene expression heatmap [from getSigGenes]
- .rnk file for downstream pathway expression analysis [from getSigGenes]
- MA Plot of gene expression (with optional highlighting of targeted genes) [from MAplot]
- Volcano plot of gene expression (with optional highlighting of targeted genes) [from VOLCplot]
- (Optional) differentially expressed gene table containing information for targeted genes only [from getSigGenes]
- Separate .csv file with all significant (p < 0.05) pathways found to be enriched from each pathway database [from PEA]
- Dotplot, GOplot (for GO results), and MAP plot for most significant pathways [from PEA]


*example data can be provided on request*
